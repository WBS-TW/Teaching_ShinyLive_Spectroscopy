library(shiny)
library(plotly)

# UV-Vis dataset för metan
methane_uvvis <- data.frame(
    wavelength = c(341.0043,338.4410,335.8993,333.3874,333.1566,332.9098,332.6553,331.0306,
                   330.3475,330.0104,328.0045,326.0223,324.0627,322.1247,320.2074,318.3098,
                   316.4311,315.9692,315.5085,315.0492,314.5489,314.0358,313.5170,309.0751,
                   306.6979,305.4673,304.5362,304.4965,304.4433,304.3832,302.5405,301.0652,
                   299.3609,299.2711,299.1748,299.0654,298.8589,298.6527,298.4468,294.7899,
                   292.4761,291.1709,290.5757,288.1978,285.8524,283.5331,282.2643,281.0009,
                   279.7374,275.5287,273.8822,273.3030,271.1884,269.9855,268.6503,267.7481,
                   266.8520,265.9619,265.2402,264.5223,263.8083,261.9340,260.5384,258.4306,
                   257.2093,256.6501,256.2666,254.4524,252.6544,250.8770,250.2370,249.8197,
                   249.2671,247.2533,246.2819,245.6895,244.6717,243.6537,242.6398,241.7464,
                   241.1876,240.8269,240.5691,240.0665,239.1541,239.0968,239.0353,238.9655,
                   238.5663,238.0596,237.5900,237.2998,236.8998,236.5720,236.2540,235.8839,
                   235.4009,235.1742,234.8912,234.5444,233.7674,233.2848,232.8914,232.3857),
    absorbance = c(0.090963,0.128755,0.166637,0.204771,0.211708,0.218667,0.225619,0.246031,
                   0.256742,0.266866,0.300769,0.334695,0.368696,0.402708,0.436751,0.470822,
                   0.504892,0.516839,0.528891,0.541167,0.547122,0.553094,0.559056,0.643255,
                   0.688562,0.710473,0.724522,0.728646,0.732988,0.737439,0.767015,0.792504,
                   0.820425,0.824549,0.828892,0.833345,0.833988,0.834853,0.835830,0.900482,
                   0.940492,0.963074,0.975459,1.009765,1.044179,1.078816,1.092380,1.106164,
                   1.120060,1.153315,1.168129,1.177205,1.182449,1.184382,1.184657,1.181529,
                   1.178180,1.174720,1.167763,1.160805,1.153848,1.118496,1.088993,1.040056,
                   0.999991,0.983888,0.977943,0.935064,0.891961,0.848749,0.842678,0.837266,
                   0.827880,0.831134,0.835056,0.838314,0.871754,0.905413,0.939185,0.985341,
                   1.018913,1.037574,1.067205,1.113619,1.205526,1.226048,1.246789,1.267641,
                   1.305646,1.364474,1.419483,1.446029,1.500327,1.539814,1.574362,1.613848,
                   1.668146,1.683367,1.709407,1.733241,1.811892,1.859330,1.894658,1.936972)
)

# IR dataset för metan (kortad version för exempel)
methane_ir <- data.frame(
    wavenumber = c(449.47, 454.148739, 458.827478, 463.506218, 468.184957, 472.863696, 477.542435, 
                   482.221174, 486.899914, 491.578653, 496.257392, 500.936131, 505.614871, 510.29361, 
                   514.972349, 519.651088, 524.329827, 529.008567, 533.687306, 538.366045, 543.044784, 
                   547.723523, 552.402263, 557.081002, 561.759741, 566.43848, 571.117219, 575.795959, 
                   580.474698, 585.153437, 589.832176, 594.510915, 599.189655, 603.868394, 608.547133, 
                   613.225872, 617.904612, 622.583351, 627.26209, 631.940829, 636.619568, 641.298308, 
                   645.977047, 650.655786, 655.334525, 660.013264, 664.692004, 669.370743, 674.049482, 
                   678.728221, 683.40696, 688.0857, 692.764439, 697.443178, 702.121917, 706.800656, 
                   711.479396, 716.158135, 720.836874, 725.515613, 730.194353, 734.873092, 739.551831, 
                   744.23057, 748.909309, 753.588049, 758.266788, 762.945527, 767.624266, 772.303005, 
                   776.981745, 781.660484, 786.339223, 791.017962, 795.696701, 800.375441, 805.05418, 
                   809.732919, 814.411658, 819.090397, 823.769137, 828.447876, 833.126615, 837.805354, 
                   842.484094, 847.162833, 851.841572, 856.520311, 861.19905, 865.87779, 870.556529, 
                   875.235268, 879.914007, 884.592746, 889.271486, 893.950225, 898.628964, 903.307703, 
                   907.986442, 912.665182, 917.343921, 922.02266, 926.701399, 931.380138, 936.058878, 
                   940.737617, 945.416356, 950.095095, 954.773835, 959.452574, 964.131313, 968.810052, 
                   973.488791, 978.167531, 982.84627, 987.525009, 992.203748, 996.882487, 1001.561227, 
                   1006.239966, 1010.918705, 1015.597444, 1020.276183, 1024.954923, 1029.633662, 1034.312401, 
                   1038.99114, 1043.669879, 1048.348619, 1053.027358, 1057.706097, 1062.384836, 1067.063576, 
                   1071.742315, 1076.421054, 1081.099793, 1085.778532, 1090.457272, 1095.136011, 1099.81475, 
                   1104.493489, 1109.172228, 1113.850968, 1118.529707, 1123.208446, 1127.887185, 1132.565924, 
                   1137.244664, 1141.923403, 1146.602142, 1151.280881, 1155.95962, 1160.63836, 1165.317099, 
                   1169.995838, 1174.674577, 1179.353317, 1184.032056, 1188.710795, 1193.389534, 1198.068273, 
                   1202.747013, 1207.425752, 1212.104491, 1216.78323, 1221.461969, 1226.140709, 1230.819448, 
                   1235.498187, 1240.176926, 1244.855665, 1249.534405, 1254.213144, 1258.891883, 1263.570622, 
                   1268.249362, 1272.928101, 1277.60684, 1282.285579, 1286.964318, 1291.643058, 1296.321797, 
                   1301.000536, 1305.679275, 1310.358014, 1315.036754, 1319.715493, 1324.394232, 1329.072971, 
                   1333.75171, 1338.43045, 1343.109189, 1347.787928, 1352.466667, 1357.145406, 1361.824146, 
                   1366.502885, 1371.181624, 1375.860363, 1380.539103, 1385.217842, 1389.896581, 1394.57532, 
                   1399.254059, 1403.932799, 1408.611538, 1413.290277, 1417.969016, 1422.647755, 1427.326495, 
                   1432.005234, 1436.683973, 1441.362712, 1446.041451, 1450.720191, 1455.39893, 1460.077669, 
                   1464.756408, 1469.435147, 1474.113887, 1478.792626, 1483.471365, 1488.150104, 1492.828844, 
                   1497.507583, 1502.186322, 1506.865061, 1511.5438, 1516.22254, 1520.901279, 1525.580018, 
                   1530.258757, 1534.937496, 1539.616236, 1544.294975, 1548.973714, 1553.652453, 1558.331192, 
                   1563.009932, 1567.688671, 1572.36741, 1577.046149, 1581.724888, 1586.403628, 1591.082367, 
                   1595.761106, 1600.439845, 1605.118585, 1609.797324, 1614.476063, 1619.154802, 1623.833541, 
                   1628.512281, 1633.19102, 1637.869759, 1642.548498, 1647.227237, 1651.905977, 1656.584716, 
                   1661.263455, 1665.942194, 1670.620933, 1675.299673, 1679.978412, 1684.657151, 1689.33589, 
                   1694.014629, 1698.693369, 1703.372108, 1708.050847, 1712.729586, 1717.408326, 1722.087065, 
                   1726.765804, 1731.444543, 1736.123282, 1740.802022, 1745.480761, 1750.1595, 1754.838239, 
                   1759.516978, 1764.195718, 1768.874457, 1773.553196, 1778.231935, 1782.910674, 1787.589414, 
                   1792.268153, 1796.946892, 1801.625631, 1806.30437, 1810.98311, 1815.661849, 1820.340588, 
                   1825.019327, 1829.698067, 1834.376806, 1839.055545, 1843.734284, 1848.413023, 1853.091763, 
                   1857.770502, 1862.449241, 1867.12798, 1871.806719, 1876.485459, 1881.164198, 1885.842937, 
                   1890.521676, 1895.200415, 1899.879155, 1904.557894, 1909.236633, 1913.915372, 1918.594112, 
                   1923.272851, 1927.95159, 1932.630329, 1937.309068, 1941.987808, 1946.666547, 1951.345286, 
                   1956.024025, 1960.702764, 1965.381504, 1970.060243, 1974.738982, 1979.417721, 1984.09646, 
                   1988.7752, 1993.453939, 1998.132678, 2002.811417, 2007.490156, 2012.168896, 2016.847635, 
                   2021.526374, 2026.205113, 2030.883853, 2035.562592, 2040.241331, 2044.92007, 2049.598809, 
                   2054.277549, 2058.956288, 2063.635027, 2068.313766, 2072.992505, 2077.671245, 2082.349984, 
                   2087.028723, 2091.707462, 2096.386201, 2101.064941, 2105.74368, 2110.422419, 2115.101158, 
                   2119.779897, 2124.458637, 2129.137376, 2133.816115, 2138.494854, 2143.173594, 2147.852333, 
                   2152.531072, 2157.209811, 2161.88855, 2166.56729, 2171.246029, 2175.924768, 2180.603507, 
                   2185.282246, 2189.960986, 2194.639725, 2199.318464, 2203.997203, 2208.675942, 2213.354682, 
                   2218.033421, 2222.71216, 2227.390899, 2232.069638, 2236.748378, 2241.427117, 2246.105856, 
                   2250.784595, 2255.463335, 2260.142074, 2264.820813, 2269.499552, 2274.178291, 2278.857031, 
                   2283.53577, 2288.214509, 2292.893248, 2297.571987, 2302.250727, 2306.929466, 2311.608205, 
                   2316.286944, 2320.965683, 2325.644423, 2330.323162, 2335.001901, 2339.68064, 2344.359379, 
                   2349.038119, 2353.716858, 2358.395597, 2363.074336, 2367.753076, 2372.431815, 2377.110554, 
                   2381.789293, 2386.468032, 2391.146772, 2395.825511, 2400.50425, 2405.182989, 2409.861728, 
                   2414.540468, 2419.219207, 2423.897946, 2428.576685, 2433.255424, 2437.934164, 2442.612903, 
                   2447.291642, 2451.970381, 2456.64912, 2461.32786, 2466.006599, 2470.685338, 2475.364077, 
                   2480.042817, 2484.721556, 2489.400295, 2494.079034, 2498.757773, 2503.436513, 2508.115252, 
                   2512.793991, 2517.47273, 2522.151469, 2526.830209, 2531.508948, 2536.187687, 2540.866426, 
                   2545.545165, 2550.223905, 2554.902644, 2559.581383, 2564.260122, 2568.938861, 2573.617601, 
                   2578.29634, 2582.975079, 2587.653818, 2592.332558, 2597.011297, 2601.690036, 2606.368775, 
                   2611.047514, 2615.726254, 2620.404993, 2625.083732, 2629.762471, 2634.44121, 2639.11995, 
                   2643.798689, 2648.477428, 2653.156167, 2657.834906, 2662.513646, 2667.192385, 2671.871124, 
                   2676.549863, 2681.228603, 2685.907342, 2690.586081, 2695.26482, 2699.943559, 2704.622299, 
                   2709.301038, 2713.979777, 2718.658516, 2723.337255, 2728.015995, 2732.694734, 2737.373473, 
                   2742.052212, 2746.730951, 2751.409691, 2756.08843, 2760.767169, 2765.445908, 2770.124647, 
                   2774.803387, 2779.482126, 2784.160865, 2788.839604, 2793.518344, 2798.197083, 2802.875822, 
                   2807.554561, 2812.2333, 2816.91204, 2821.590779, 2826.269518, 2830.948257, 2835.626996, 
                   2840.305736, 2844.984475, 2849.663214, 2854.341953, 2859.020692, 2863.699432, 2868.378171, 
                   2873.05691, 2877.735649, 2882.414388, 2887.093128, 2891.771867, 2896.450606, 2901.129345, 
                   2905.808085, 2910.486824, 2915.165563, 2919.844302, 2924.523041, 2929.201781, 2933.88052, 
                   2938.559259, 2943.237998, 2947.916737, 2952.595477, 2957.274216, 2961.952955, 2966.631694, 
                   2971.310433, 2975.989173, 2980.667912, 2985.346651, 2990.02539, 2994.704129, 2999.382869, 
                   3004.061608, 3008.740347, 3013.419086, 3018.097826, 3022.776565, 3027.455304, 3032.134043, 
                   3036.812782, 3041.491522, 3046.170261, 3050.849, 3055.527739, 3060.206478, 3064.885218, 3069.563957, 
                   3074.242696, 3078.921435, 3083.600174, 3088.278914, 3092.957653, 3097.636392, 3102.315131, 3106.99387,
                   3111.67261, 3116.351349, 3121.030088, 3125.708827, 3130.387567, 3135.066306, 3139.745045, 3144.423784,
                   3149.102523, 3153.781263, 3158.460002, 3163.138741, 3167.81748, 3172.496219, 3177.174959, 3181.853698, 
                   3186.532437, 3191.211176, 3195.889915, 3200.568655, 3205.247394, 3209.926133, 3214.604872, 3219.283611, 
                   3223.962351, 3228.64109, 3233.319829, 3237.998568, 3242.677308, 3247.356047, 3252.034786, 3256.713525, 
                   3261.392264, 3266.071004, 3270.749743, 3275.428482, 3280.107221, 3284.78596, 3289.4647, 3294.143439, 
                   3298.822178, 3303.500917, 3308.179656, 3312.858396, 3317.537135, 3322.215874, 3326.894613, 3331.573353, 
                   3336.252092, 3340.930831, 3345.60957, 3350.288309, 3354.967049, 3359.645788, 3364.324527, 3369.003266, 
                   3373.682005, 3378.360745, 3383.039484, 3387.718223, 3392.396962, 3397.075701, 3401.754441, 3406.43318, 
                   3411.111919, 3415.790658, 3420.469397, 3425.148137, 3429.826876, 3434.505615, 3439.184354, 3443.863094, 
                   3448.541833, 3453.220572, 3457.899311, 3462.57805, 3467.25679, 3471.935529, 3476.614268, 3481.293007, 
                   3485.971746, 3490.650486, 3495.329225, 3500.007964, 3504.686703, 3509.365442, 3514.044182, 3518.722921, 
                   3523.40166, 3528.080399, 3532.759138, 3537.437878, 3542.116617, 3546.795356, 3551.474095, 3556.152835, 
                   3560.831574, 3565.510313, 3570.189052, 3574.867791, 3579.546531, 3584.22527, 3588.904009, 3593.582748, 
                   3598.261487, 3602.940227, 3607.618966, 3612.297705, 3616.976444, 3621.655183, 3626.333923, 3631.012662, 
                   3635.691401, 3640.37014, 3645.048879, 3649.727619, 3654.406358, 3659.085097, 3663.763836, 3668.442576, 
                   3673.121315, 3677.800054, 3682.478793, 3687.157532, 3691.836272, 3696.515011, 3701.19375, 3705.872489,
                   3710.551228, 3715.229968, 3719.908707, 3724.587446, 3729.266185, 3733.944924, 3738.623664, 3743.302403, 
                   3747.981142, 3752.659881, 3757.33862, 3762.01736, 3766.696099, 3771.374838, 3776.053577, 3780.732317, 
                   3785.411056, 3790.089795, 3794.768534),
    transmittance = c(0.953, 0.953, 0.953, 0.952, 0.953, 0.956, 0.953, 0.953, 0.953, 0.952, 0.952, 0.952, 0.949, 0.949, 0.948, 
                      0.948, 0.948, 0.949, 0.949, 0.948, 0.951, 0.951, 0.953, 0.953, 0.955, 0.956, 0.959, 0.959, 0.961, 0.962, 
                      0.963, 0.965, 0.968, 0.969, 0.969, 0.971, 0.971, 0.971, 0.972, 0.972, 0.974, 0.975, 0.975, 0.975, 0.976, 
                      0.976, 0.976, 0.976, 0.978, 0.979, 0.981, 0.982, 0.984, 0.985, 0.988, 0.988, 0.989, 0.989, 1.037, 0.988, 
                      0.989, 0.992, 0.991, 0.991, 0.991, 0.988, 0.988, 0.987, 0.987, 0.987, 0.987, 0.985, 0.985, 0.985, 0.985,
                      0.984, 0.984, 0.984, 0.984, 0.984, 0.984, 0.985, 0.985, 0.985, 0.985, 0.985, 0.985, 0.985, 0.985, 0.985, 
                      0.985, 0.984, 0.984, 0.985, 0.985, 0.985, 0.985, 0.985, 0.987, 0.988, 0.989, 0.989, 0.989, 0.989, 0.991, 
                      0.991, 0.991, 0.992, 0.994, 0.997, 0.995, 0.997, 0.998, 0.998, 1.001, 1.001, 1.001, 1.001, 1.001, 1.001, 
                      1.001, 1.002, 1.002, 1.004, 1.007, 1.004, 1.002, 1.002, 1.002, 1.002, 1.002, 1.001, 1.001, 0.997, 1.002, 
                      1.004, 1.001, 1.001, 1.002, 1.002, 1.002, 1.004, 1.004, 1.004, 1.004, 1.002, 1, 0.994, 0.994, 1, 1.001, 
                      1.001, 1.002, 1, 0.998, 0.992, 0.981, 0.995, 0.981, 0.989, 0.988, 0.984, 0.994, 1.0139, 0.935, 0.881, 0.9581, 
                      0.769, 0.7989, 0.8959, 0.7679, 0.729, 0.618, 0.7231, 0.6421, 0.603, 0.6522, 0.599, 0.7856, 0.876, 0.818, 0.553, 
                      0.3047, 0.028, 0.9347, 0.961, 0.945, 0.9159, 0.4775, 0.445, 0.4028, 0.6441, 0.6813, 0.68, 0.6665, 0.4689, 0.659, 
                      0.864, 0.6775, 0.871, 0.914, 0.958, 0.972, 0.979, 0.982, 0.984, 0.984, 0.978, 0.982, 0.984, 0.975, 0.981, 0.981, 
                      0.981, 0.979, 0.972, 0.981, 0.974, 0.984, 0.974, 0.987, 0.981, 0.987, 0.987, 0.988, 0.985, 0.987, 0.989, 0.989, 
                      0.989, 0.991, 0.991, 0.971, 0.945, 0.965, 0.976, 0.981, 0.984, 0.985, 0.988, 0.985, 0.984, 0.987, 0.987, 0.989, 
                      0.987, 0.985, 0.985, 0.979, 0.984, 0.984, 0.981, 0.985, 0.984, 0.982, 0.975, 0.981, 0.978, 0.985, 0.985, 0.981, 
                      0.979, 0.981, 0.984, 0.982, 0.985, 0.979, 0.979, 0.979, 0.979, 0.978, 0.981, 0.979, 0.979, 0.979, 0.982, 0.981, 
                      0.981, 0.981, 0.982, 0.982, 0.982, 0.982, 0.985, 0.984, 0.984, 0.985, 0.985, 0.985, 0.985, 0.988, 0.988, 0.987, 
                      0.985, 0.985, 0.987, 0.987, 0.985, 0.985, 0.985, 0.985, 0.985, 0.987, 0.987, 0.985, 0.985, 0.987, 0.985, 0.984, 
                      0.984, 0.984, 0.984, 0.982, 0.982, 0.982, 0.985, 0.984, 0.982, 0.982, 0.984, 0.982, 0.982, 0.984, 0.987, 0.987, 
                      0.989, 0.988, 0.988, 0.989, 0.989, 0.991, 0.991, 0.9915, 0.991, 0.991, 0.991, 0.991, 0.9891, 0.9899, 0.991, 0.991, 
                      0.989, 0.9902, 0.989, 0.989, 0.989, 0.989, 0.989, 0.989, 0.989, 0.989, 0.989, 0.989, 0.989, 0.989, 0.989, 0.989, 
                      0.988, 0.989, 0.9882, 0.988, 0.988, 0.988, 0.988, 0.988, 0.988, 0.989, 0.989, 0.991, 0.991, 0.991, 0.991, 0.991, 
                      0.989, 0.991, 0.991, 0.991, 0.991, 0.991, 0.991, 0.991, 0.991, 0.991, 0.991, 0.991, 0.991, 0.991, 0.991, 0.991, 
                      0.991, 0.989, 0.989, 0.989, 0.988, 0.987, 0.987, 0.985, 0.9845, 0.982, 0.98, 0.978, 0.975, 0.972, 0.9715, 0.9691, 
                      0.969, 0.971, 0.9714, 0.9739, 0.9793, 0.9819, 0.9858, 0.989, 0.9914, 0.992, 0.994, 0.994, 0.994, 0.994, 0.9933, 
                      0.992, 0.991, 0.991, 0.992, 0.992, 0.992, 0.992, 0.992, 0.992, 0.992, 0.9912, 0.991, 0.9895, 0.989, 0.988, 0.9878, 
                      0.987, 0.9895, 0.989, 0.989, 0.988, 0.9882, 0.989, 0.9882, 0.9896, 0.989, 0.989, 0.989, 0.988, 0.987, 0.987, 0.9871,
                      0.989, 0.991, 0.991, 0.989, 0.989, 0.988, 0.9853, 0.981, 0.9831, 0.987, 0.987, 0.988, 0.9866, 0.985, 0.9845, 0.987, 
                      0.987, 0.987, 0.984, 0.984, 0.9875, 0.985, 0.9845, 0.9821, 0.9785, 0.976, 0.9846, 0.9766, 0.9728, 0.9868, 0.9838, 0.953,
                      0.984, 0.988, 0.9768, 0.949, 0.9863, 0.9811, 0.933, 0.979, 0.9773, 0.9624, 0.9709, 0.9611, 0.9522, 0.9655, 0.9749, 0.9598, 
                      0.9466, 0.9599, 0.9617, 0.9625, 0.966, 0.9595, 0.9223, 0.9093, 0.918, 0.9355, 0.96, 0.975, 0.972, 0.9696, 0.9453, 0.939, 
                      0.8981, 0.9158, 0.9298, 0.8035, 0.9235, 0.852, 0.942, 0.6449, 0.912, 0.559, 0.9272, 0.636, 0.452, 0.8115, 0.4631, 0.784, 
                      0.6094, 0.9361, 0.419, 0.9328, 0.6167, 0.6822, 0.7752, 0.6533, 0.943, 0.7135, 0.704, 0.566, 0.955, 0.7915, 0.5485, 0.4158, 
                      0.2203, 0.6267, 0.775, 0.8579, 0.9244, 0.8115, 0.9359, 0.646, 0.6633, 0.6139, 0.5252, 0.8104, 0.5011, 0.8239, 0.712, 0.5521,
                      0.461, 0.6147, 0.8997, 0.5716, 0.8762, 0.6285, 0.8581, 0.5897, 0.8946, 0.644, 0.9631, 0.7827, 0.9782, 0.727, 0.9853, 0.8325,
                      0.989, 0.8824, 0.952, 0.9782, 0.983, 0.9845, 0.989, 0.9911, 0.992, 0.9953, 0.997, 0.997, 0.997, 0.998, 0.998, 0.998, 0.998,
                      0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 
                      0.998, 0.998, 0.998, 0.998, 0.9998, 1, 1, 1, 1, 1, 0.9983, 0.998, 0.998, 0.997, 0.995, 0.995, 0.9966, 0.9973, 0.9972, 0.998, 
                      0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 1, 1, 1, 1.0007, 1.001, 1.001, 1.001, 1.001, 1.001, 1.001, 1, 
                      1, 1, 1, 1, 1, 1, 1, 1, 0.9988, 0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 0.998, 0.998,
                      0.998, 0.998, 0.998, 0.998, 0.998, 1, 0.9981, 0.998, 0.998, 0.998, 0.998, 0.995, 0.995, 0.9974, 0.998, 1, 0.998, 0.998, 1, 1.0007,
                      0.998, 0.9986, 1, 0.998, 1, 1, 0.9996, 1.001, 1.002, 1.002, 1.002, 1.002, 1.0013, 1.001, 1.001, 1.0008, 1, 0.9978)
)



##--------------------------------------------------------------------------##

# UI
ui <- fluidPage(
    titlePanel("Spektroskopi"),
    
    sidebarLayout(
        sidebarPanel(
            selectInput("specType", "Välj spektroskopityp:",
                        choices = c("UV-Vis", "IR")),
            helpText("Zooma och panorera")
        ),
        
        mainPanel(
            plotlyOutput("specPlot"),
            verbatimTextOutput("specExplanation")
        )
    )
)

# Server
server <- function(input, output) {
    
    output$specPlot <- renderPlotly({
        if (input$specType == "UV-Vis") {
            plot_ly(data = methane_uvvis, x = ~wavelength, y = ~absorbance, type = 'scatter', mode = 'lines',
                    line = list(color = 'blue')) %>%
                layout(title = "UV-Vis-spektrum för metan",
                       xaxis = list(title = "Våglängd (nm)"),
                       yaxis = list(title = "Absorbans"))
        } else {
            plot_ly(data = methane_ir, x = ~wavenumber, y = ~transmittance, type = 'scatter', mode = 'lines',
                    line = list(color = 'red')) %>%
                layout(title = "IR-spektrum för metan",
                       xaxis = list(title = "Vågtal (cm⁻¹)"),
                       yaxis = list(title = "Transmittans"))
        }
    })
    
    output$specExplanation <- renderText({
        if (input$specType == "UV-Vis") {
            "UV-Vis-spektroskopi mäter absorbans av ljus i det ultravioletta och synliga området. Här visas metans spektrum."
        } else {
            "IR-spektroskopi detekterar molekylära vibrationer. Här visas metans IR-spektrum."
        }
    })
}

shinyApp(ui = ui, server = server)